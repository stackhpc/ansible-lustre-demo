# -- general ---
ansible_user: centos

# --- ansible-role-lustre ---
lustre_install_type: patchless-ldiskfs-server
lustre_manage_repo: true
lustre_format_disks: true
lustre_format_mgs:
  device: "{{ loopdev_mgt }}"
lustre_format_mdts:
  - device: "{{ loopdev_mdt }}"
    index: 0
    mgs_nodes: "{{ networks[lustre_core_network] }}@{{ lustre_core_lnet }}"
lustre_format_osts:
  - device: "{{ loopdev_ost0 }}"
    index: 0
    mgs_nodes: "{{ networks[lustre_core_network] }}@{{ lustre_core_lnet }}"
lustre_mount_disks: true

#lustre_admin_ips: "{{ hostvars | dict2items | selectattr('value.group_names', 'contains', 'admin') | map(attribute='value.networks.' + lustre_core_network) | ipaddr('int') | sort | ipaddr }}"
lustre_admin_nids: "{{ hostvars | dict2items | selectattr('value.group_names', 'contains', 'admin') | map(attribute='lustre_core_nids') | sort }}"

lustre_nodemaps:
  - name: admin
    admin_nodemap: true
    trusted_nodemap: true
    ranges:
      # - start_nid: "{{ lustre_admin_ips | first }}@{{ lustre_core_lnet }}"
      #   end_nid: "{{ lustre_admin_ips | last }}@{{ lustre_core_lnet }}"
  - name: projectA
    admin_nodemap: false
    trusted_nodemap: false
    ranges:
      - start_nid: "{{ hostvars['stackhpc-projectA-exporter'].lustre_core_nid"
        end_nid: "{{ hostvars['stackhpc-projectA-exporter'].lustre_core_nid"


