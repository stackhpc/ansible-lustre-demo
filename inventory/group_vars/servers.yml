# -- general ---
ansible_user: centos

# --- ansible-role-lustre ---
lustre_install_type: patchless-ldiskfs-server
lustre_manage_repo: true
lustre_format_disks: true
lustre_format_mgs:
  device: "{{ loopdev_mgt }}"
lustre_format_mdts:
  - device: "{{ loopdev_mdt }}"
    index: 0
    mgs_nodes: "{{ networks[lustre_network] }}@tcp1"
lustre_format_osts:
  - device: "{{ loopdev_ost0 }}"
    index: 0
    mgs_nodes: "{{ networks[lustre_network] }}@tcp1"
lustre_mount_disks: true

lustre_client_addresses: "{{ hostvars | dict2items | selectattr('value.group_names', 'contains', 'clients') | map(attribute='value.networks.' + lustre_network) | ipaddr('int') | sort | ipaddr }}"
lustre_lnet: "{{ lustre_lnet_lnetctl_networks.keys() | first }}"

lustre_nodemaps:
  - name: test
    # admin_nodemap: true/[false]
    # audit_mode: [true]/false
    # deny_unknown: true/[false]
    # fileset: ''
    # idmaps: []
      # - client_id:
      #   fs_id:
      #   idtype:
    ranges:
      - start_nid: "{{ lustre_client_addresses | first }}@{{ lustre_lnet }}"
        end_nid: "{{ lustre_client_addresses | last }}@{{ lustre_lnet }}"
# squash_gid: 99
# squash_uid: 99
# trusted_nodemap: true/[false]
